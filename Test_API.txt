                                        "model"
=============================
 "register"
-------------------------------------------------
{
    "email":"esraasyam15@gmail.com",
    "userName" :"جني محمد",
    "password":"esraa55",
    "fatherName":"محمد",
    "motherName":"ايه",
    "phoneNumber":"01016776619",
    "NationalID": "30205784578988",
    "birthDate":"2002-05-10",
    "bloodType":"O+"
}

url : https://kid-care.onrender.com/api/v1/auth/register
=================================
login 
--------------------------------
{
    "email" : "esraasyam15@gmail.com",
    "password":"584199"
}
ulr : https://kid-care.onrender.com/api/v1/auth/login

===============================
forget password
--------------------------------
{
    "email" : "esraasyam15@gmail.com"
}

url : https://kid-care.onrender.com/password/forgot-password

//http://localhost:3000/reset-password?token=abcdef123456&email=user@example.com

const jwt = require('jsonwebtoken');
const User = require('./models/User');

// Function to get user from token
const getUserFromToken = async (token) => {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    const id = decoded._id;
    return await User.findById(id);
};

const getUserProfile = async (req, res) => {
    try {
        const token = req.headers['authorization'];
        if (!token) {
            return res.status(401).send({
                status: false,
                message: "توكن مفقود",
            });
        }

        const user = await getUserFromToken(token);

        if (!user) {
            return res.status(404).send({
                status: false,
                message: "المستخدم غير مسجل",
            });
        }

        res.status(200).send({
            status: true,
            message: "تم العثور على الملف الشخصي",
            user
        });

    } catch (error) {
        console.log(error);
        if (error.name === 'JsonWebTokenError') {
            return res.status(401).send({
                status: false,
                message: "توكن غير صالح",
            });
        }
        res.status(500).send({
            status: false,
            message: "خطأ في عملية البحث عن الملف الشخصي",
            error: error.message,
        });
    }
};

module.exports = {
    getUserFromToken,
    getUserProfile
};
